/**
 * TimelineFrame holds 3 list of FrameCommands
 *  - list1 _frameCommands should be  executed when playing the timeline (previous Frame was played)
 *  - list2 _frameCommandsReverse should be executed when playing the timeline reversed (previous Frame was played)
 *  - list3 _frameCommandsInit should be executed when jumping to a frame, so we need to fully init the frame
 *
 *  Addionial TimelineFrame properties are:
 *  - script - can be executed, after the frameCommands have been executed
 *  - list of FrameLabels, and list of corresponding labelTypes
 *  - duration-value (1 frame is not necessary 1 frame long)
 *  - startTime and endTime are needed internally when deciding what frame to display
 */
var TimelineKeyFrame = (function () {
    function TimelineKeyFrame() {
        this._duration = 1; //use millisecs for duration ? or frames ?
        this._frameCommands = new Array();
        this._frameConstructCommands = new Array();
        this._frameDestructCommands = new Array();
        this._isActive = false;
    }
    TimelineKeyFrame.prototype.addCommand = function (command) {
        // make the timeline available for the commands
        this._frameCommands.push(command);
    };
    TimelineKeyFrame.prototype.addConstructCommand = function (command) {
        // make the timeline available for the commands
        this._frameConstructCommands.push(command);
    };
    TimelineKeyFrame.prototype.addDestructCommand = function (command) {
        // make the timeline available for the commands
        this._frameDestructCommands.push(command);
    };
    Object.defineProperty(TimelineKeyFrame.prototype, "startTime", {
        get: function () {
            return this._startTime;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimelineKeyFrame.prototype, "duration", {
        get: function () {
            return this._duration;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimelineKeyFrame.prototype, "endTime", {
        get: function () {
            return this._endTime;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TimelineKeyFrame.prototype, "isActive", {
        get: function () {
            return this._isActive;
        },
        enumerable: true,
        configurable: true
    });
    TimelineKeyFrame.prototype.setFrameTime = function (startTime, duration) {
        this._startTime = startTime;
        this._duration = duration;
        this._endTime = startTime + duration;
    };
    TimelineKeyFrame.prototype.activate = function (sourceMovieClip) {
        this._isActive = true;
        var len = this._frameConstructCommands.length;
        for (var i = 0; i < len; i++)
            this._frameConstructCommands[i].execute(sourceMovieClip, this._startTime);
    };
    TimelineKeyFrame.prototype.deactivate = function (sourceMovieClip) {
        this._isActive = false;
        var len = this._frameDestructCommands.length;
        var endTime = this._duration + this._startTime;
        for (var i = 0; i < len; i++)
            this._frameDestructCommands[i].execute(sourceMovieClip, endTime);
    };
    TimelineKeyFrame.prototype.update = function (sourceMovieClip, time) {
        var len = this._frameCommands.length;
        for (var i = 0; i < len; i++)
            this._frameCommands[i].execute(sourceMovieClip, time);
    };
    return TimelineKeyFrame;
})();
module.exports = TimelineKeyFrame;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1wbGF5ZXIvbGliL3RpbWVsaW5lL1RpbWVsaW5lS2V5RnJhbWUudHMiXSwibmFtZXMiOlsiVGltZWxpbmVLZXlGcmFtZSIsIlRpbWVsaW5lS2V5RnJhbWUuY29uc3RydWN0b3IiLCJUaW1lbGluZUtleUZyYW1lLmFkZENvbW1hbmQiLCJUaW1lbGluZUtleUZyYW1lLmFkZENvbnN0cnVjdENvbW1hbmQiLCJUaW1lbGluZUtleUZyYW1lLmFkZERlc3RydWN0Q29tbWFuZCIsIlRpbWVsaW5lS2V5RnJhbWUuc3RhcnRUaW1lIiwiVGltZWxpbmVLZXlGcmFtZS5kdXJhdGlvbiIsIlRpbWVsaW5lS2V5RnJhbWUuZW5kVGltZSIsIlRpbWVsaW5lS2V5RnJhbWUuaXNBY3RpdmUiLCJUaW1lbGluZUtleUZyYW1lLnNldEZyYW1lVGltZSIsIlRpbWVsaW5lS2V5RnJhbWUuYWN0aXZhdGUiLCJUaW1lbGluZUtleUZyYW1lLmRlYWN0aXZhdGUiLCJUaW1lbGluZUtleUZyYW1lLnVwZGF0ZSJdLCJtYXBwaW5ncyI6IkFBcUJBLEFBWUE7Ozs7Ozs7Ozs7O0dBREc7SUFDRyxnQkFBZ0I7SUFVbEJBLFNBVkVBLGdCQUFnQkE7UUFZZEMsSUFBSUEsQ0FBQ0EsU0FBU0EsR0FBR0EsQ0FBQ0EsRUFBQ0EsMENBQTBDQTtRQUM3REEsSUFBSUEsQ0FBQ0EsY0FBY0EsR0FBR0EsSUFBSUEsS0FBS0EsRUFBZ0JBLENBQUNBO1FBQ2hEQSxJQUFJQSxDQUFDQSx1QkFBdUJBLEdBQUdBLElBQUlBLEtBQUtBLEVBQWdCQSxDQUFDQTtRQUN6REEsSUFBSUEsQ0FBQ0Esc0JBQXNCQSxHQUFHQSxJQUFJQSxLQUFLQSxFQUFnQkEsQ0FBQ0E7UUFDeERBLElBQUlBLENBQUNBLFNBQVNBLEdBQUdBLEtBQUtBLENBQUNBO0lBQzNCQSxDQUFDQTtJQUVNRCxxQ0FBVUEsR0FBakJBLFVBQWtCQSxPQUFvQkE7UUFFbENFLEFBQ0FBLCtDQUQrQ0E7UUFDL0NBLElBQUlBLENBQUNBLGNBQWNBLENB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LEVBQUVBLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLENBQUNBLEVBQUVBO1lBQ3hCQSxJQUFJQSxDQUFDQSxjQUFjQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQSxPQUFPQSxDQUFDQSxlQUFlQSxFQUFFQSxJQUFJQSxDQUFDQSxDQUFDQTtJQUM5REEsQ0FBQ0E7SUFDTFosdUJBQUNBO0FBQURBLENBMUZBLEFBMEZDQSxJQUFBO0FBRUQsQUFBMEIsaUJBQWpCLGdCQUFnQixDQUFDIiwiZmlsZSI6InRpbWVsaW5lL1RpbWVsaW5lS2V5RnJhbWUuanMiLCJzb3VyY2VSb290IjoiLi4vIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFzc2V0VHlwZSAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2xpYnJhcnkvQXNzZXRUeXBlXCIpO1xuaW1wb3J0IElBc3NldCAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9saWJyYXJ5L0lBc3NldFwiKTtcbmltcG9ydCBNYXRyaXgzRCAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeDNEXCIpO1xuaW1wb3J0IE1hdHJpeCAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeFwiKTtcbmltcG9ydCBTdWJHZW9tZXRyeUJhc2UgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2RhdGEvU3ViR2VvbWV0cnlCYXNlXCIpO1xuaW1wb3J0IFN1Ykdlb21ldHJ5ICAgICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZGF0YS9UcmlhbmdsZVN1Ykdlb21ldHJ5XCIpO1xuaW1wb3J0IEdlb21ldHJ5ICAgICAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2RhdGEvR2VvbWV0cnlcIik7XG5pbXBvcnQgR2VvbWV0cnlFdmVudCAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXZlbnRzL0dlb21ldHJ5RXZlbnRcIik7XG5cbmltcG9ydCBJQW5pbWF0b3IgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9hbmltYXRvcnMvSUFuaW1hdG9yXCIpO1xuaW1wb3J0IElTdWJNZXNoICAgICAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2Jhc2UvSVN1Yk1lc2hcIik7XG5pbXBvcnQgSVN1Yk1lc2hDbGFzcyAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9JU3ViTWVzaENsYXNzXCIpO1xuaW1wb3J0IE1hdGVyaWFsQmFzZSAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9NYXRlcmlhbEJhc2VcIik7XG5pbXBvcnQgRW50aXR5Tm9kZSAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3BhcnRpdGlvbi9FbnRpdHlOb2RlXCIpO1xuaW1wb3J0IElSZW5kZXJlciAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3JlbmRlci9JUmVuZGVyZXJcIik7XG5pbXBvcnQgRGlzcGxheU9iamVjdENvbnRhaW5lciAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2NvbnRhaW5lcnMvRGlzcGxheU9iamVjdENvbnRhaW5lclwiKTtcbmltcG9ydCBNZXNoICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9NZXNoXCIpO1xuaW1wb3J0IE1vdmllQ2xpcCAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLXBsYXllci9saWIvZGlzcGxheS9Nb3ZpZUNsaXBcIik7XG5pbXBvcnQgRnJhbWVDb21tYW5kICAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtcGxheWVyL2xpYi90aW1lbGluZS9jb21tYW5kcy9GcmFtZUNvbW1hbmRcIik7XG5cblxuLyoqXG4gKiBUaW1lbGluZUZyYW1lIGhvbGRzIDMgbGlzdCBvZiBGcmFtZUNvbW1hbmRzXG4gKiAgLSBsaXN0MSBfZnJhbWVDb21tYW5kcyBzaG91bGQgYmUgIGV4ZWN1dGVkIHdoZW4gcGxheWluZyB0aGUgdGltZWxpbmUgKHByZXZpb3VzIEZyYW1lIHdhcyBwbGF5ZWQpXG4gKiAgLSBsaXN0MiBfZnJhbWVDb21tYW5kc1JldmVyc2Ugc2hvdWxkIGJlIGV4ZWN1dGVkIHdoZW4gcGxheWluZyB0aGUgdGltZWxpbmUgcmV2ZXJzZWQgKHByZXZpb3VzIEZyYW1lIHdhcyBwbGF5ZWQpXG4gKiAgLSBsaXN0MyBfZnJhbWVDb21tYW5kc0luaXQgc2hvdWxkIGJlIGV4ZWN1dGVkIHdoZW4ganVtcGluZyB0byBhIGZyYW1lLCBzbyB3ZSBuZWVkIHRvIGZ1bGx5IGluaXQgdGhlIGZyYW1lXG4gKlxuICogIEFkZGlvbmlhbCBUaW1lbGluZUZyYW1lIHByb3BlcnRpZXMgYXJlOlxuICogIC0gc2NyaXB0IC0gY2FuIGJlIGV4ZWN1dGVkLCBhZnRlciB0aGUgZnJhbWVDb21tYW5kcyBoYXZlIGJlZW4gZXhlY3V0ZWRcbiAqICAtIGxpc3Qgb2YgRnJhbWVMYWJlbHMsIGFuZCBsaXN0IG9mIGNvcnJlc3BvbmRpbmcgbGFiZWxUeXBlc1xuICogIC0gZHVyYXRpb24tdmFsdWUgKDEgZnJhbWUgaXMgbm90IG5lY2Vzc2FyeSAxIGZyYW1lIGxvbmcpXG4gKiAgLSBzdGFydFRpbWUgYW5kIGVuZFRpbWUgYXJlIG5lZWRlZCBpbnRlcm5hbGx5IHdoZW4gZGVjaWRpbmcgd2hhdCBmcmFtZSB0byBkaXNwbGF5XG4gKi9cbmNsYXNzIFRpbWVsaW5lS2V5RnJhbWVcbntcbiAgICBwcml2YXRlIF9zdGFydFRpbWU6bnVtYmVyO1xuICAgIHByaXZhdGUgX2VuZFRpbWU6bnVtYmVyO1xuICAgIHByaXZhdGUgX2R1cmF0aW9uOm51bWJlcjtcbiAgICBwcml2YXRlIF9mcmFtZUNvbW1hbmRzOkFycmF5PEZyYW1lQ29tbWFuZD47XG4gICAgcHJpdmF0ZSBfZnJhbWVDb25zdHJ1Y3RDb21tYW5kczpBcnJheTxGcmFtZUNvbW1hbmQ+O1xuICAgIHByaXZhdGUgX2ZyYW1lRGVzdHJ1Y3RDb21tYW5kczpBcnJheTxGcmFtZUNvbW1hbmQ+O1xuICAgIHByaXZhdGUgX2lzQWN0aXZlOmJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcigpXG4gICAge1xuICAgICAgICB0aGlzLl9kdXJhdGlvbiA9IDE7Ly91c2UgbWlsbGlzZWNzIGZvciBkdXJhdGlvbiA/IG9yIGZyYW1lcyA/XG4gICAgICAgIHRoaXMuX2ZyYW1lQ29tbWFuZHMgPSBuZXcgQXJyYXk8RnJhbWVDb21tYW5kPigpO1xuICAgICAgICB0aGlzLl9mcmFtZUNvbnN0cnVjdENvbW1hbmRzID0gbmV3IEFycmF5PEZyYW1lQ29tbWFuZD4oKTtcbiAgICAgICAgdGhpcy5fZnJhbWVEZXN0cnVjdENvbW1hbmRzID0gbmV3IEFycmF5PEZyYW1lQ29tbWFuZD4oKTtcbiAgICAgICAgdGhpcy5faXNBY3RpdmUgPSBmYWxzZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkQ29tbWFuZChjb21tYW5kOkZyYW1lQ29tbWFuZClcbiAgICB7XG4gICAgICAgIC8vIG1ha2UgdGhlIHRpbWVsaW5lIGF2YWlsYWJsZSBmb3IgdGhlIGNvbW1hbmRzXG4gICAgICAgIHRoaXMuX2ZyYW1lQ29tbWFuZHMucHVzaChjb21tYW5kKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkQ29uc3RydWN0Q29tbWFuZChjb21tYW5kOkZyYW1lQ29tbWFuZClcbiAgICB7XG4gICAgICAgIC8vIG1ha2UgdGhlIHRpbWVsaW5lIGF2YWlsYWJsZSBmb3IgdGhlIGNvbW1hbmRzXG4gICAgICAgIHRoaXMuX2ZyYW1lQ29uc3RydWN0Q29tbWFuZHMucHVzaChjb21tYW5kKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWRkRGVzdHJ1Y3RDb21tYW5kKGNvbW1hbmQ6RnJhbWVDb21tYW5kKVxuICAgIHtcbiAgICAgICAgLy8gbWFrZSB0aGUgdGltZWxpbmUgYXZhaWxhYmxlIGZvciB0aGUgY29tbWFuZHNcbiAgICAgICAgdGhpcy5fZnJhbWVEZXN0cnVjdENvbW1hbmRzLnB1c2goY29tbWFuZCk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBzdGFydFRpbWUoKTpudW1iZXJcbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zdGFydFRpbWU7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBkdXJhdGlvbigpOm51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2R1cmF0aW9uO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgZW5kVGltZSgpOm51bWJlclxuICAgIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VuZFRpbWU7XG4gICAgfVxuXG4gICAgcHVibGljIGdldCBpc0FjdGl2ZSgpOmJvb2xlYW5cbiAgICB7XG4gICAgICAgIHJldHVybiB0aGlzLl9pc0FjdGl2ZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgc2V0RnJhbWVUaW1lKHN0YXJ0VGltZTpudW1iZXIsIGR1cmF0aW9uOm51bWJlcilcbiAgICB7XG4gICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IHN0YXJ0VGltZTtcbiAgICAgICAgdGhpcy5fZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgdGhpcy5fZW5kVGltZSA9IHN0YXJ0VGltZSArIGR1cmF0aW9uO1xuICAgIH1cblxuICAgIHB1YmxpYyBhY3RpdmF0ZShzb3VyY2VNb3ZpZUNsaXA6TW92aWVDbGlwKVxuICAgIHtcbiAgICAgICAgdGhpcy5faXNBY3RpdmUgPSB0cnVlO1xuICAgICAgICB2YXIgbGVuID0gdGhpcy5fZnJhbWVDb25zdHJ1Y3RDb21tYW5kcy5sZW5ndGg7XG4gICAgICAgIC8vIHJhdGhlciBwb2ludGxlc3MgdG8gcGFzcyB0aW1lIGluZm8gaGVyZVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKVxuICAgICAgICAgICAgdGhpcy5fZnJhbWVDb25zdHJ1Y3RDb21tYW5kc1tpXS5leGVjdXRlKHNvdXJjZU1vdmllQ2xpcCwgdGhpcy5fc3RhcnRUaW1lKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZGVhY3RpdmF0ZShzb3VyY2VNb3ZpZUNsaXA6TW92aWVDbGlwKVxuICAgIHtcbiAgICAgICAgdGhpcy5faXNBY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMuX2ZyYW1lRGVzdHJ1Y3RDb21tYW5kcy5sZW5ndGg7XG4gICAgICAgIHZhciBlbmRUaW1lID0gdGhpcy5fZHVyYXRpb24gKyB0aGlzLl9zdGFydFRpbWU7XG4gICAgICAgIC8vIHJhdGhlciBwb2ludGxlc3MgdG8gcGFzcyB0aW1lIGluZm8gaGVyZVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKVxuICAgICAgICAgICAgdGhpcy5fZnJhbWVEZXN0cnVjdENvbW1hbmRzW2ldLmV4ZWN1dGUoc291cmNlTW92aWVDbGlwLCBlbmRUaW1lKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgdXBkYXRlKHNvdXJjZU1vdmllQ2xpcDpNb3ZpZUNsaXAsIHRpbWU6bnVtYmVyKVxuICAgIHtcbiAgICAgICAgdmFyIGxlbiA9IHRoaXMuX2ZyYW1lQ29tbWFuZHMubGVuZ3RoO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspXG4gICAgICAgICAgICB0aGlzLl9mcmFtZUNvbW1hbmRzW2ldLmV4ZWN1dGUoc291cmNlTW92aWVDbGlwLCB0aW1lKTtcbiAgICB9XG59XG5cbmV4cG9ydCA9IFRpbWVsaW5lS2V5RnJhbWU7XG4iXX0=